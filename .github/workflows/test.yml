on:
  push:
    branches:
      - 'master'
      
name: Tests
jobs:
  runTests:
    name: My test
    runs-on: ubuntu-latest
    steps:
      - name: Check branch name length
        if: $(echo ${{ GITHUB_REF }} | wc -c) > 30
        run: |
          echo '::set-env name=TAG::$(echo ${{ GITHUB_REF }} | grep -o -P "^.+/" | sed 's+/$++' | tr '[:upper:]' '[:lower:]' | sed "s+/+-+g")'
        env:
          ACTIONS_ALLOW_UNSECURE_COMMANDS: 'true'
      - name: Set tag
        if: $(echo ${{ GITHUB_REF }} | wc -c) < 30
        run: echo '::set-env name=TAG::$(echo ${{ GITHUB_REF }} | tr '[:upper:]' '[:lower:]' | sed "s+/+-+g")'
        env:
          ACTIONS_ALLOW_UNSECURE_COMMANDS: 'true'
      - name: run test
        run: echo $TAG
          
    
